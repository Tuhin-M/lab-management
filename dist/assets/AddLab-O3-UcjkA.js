import{x as w,R as b,s as e,O as p,J as u}from"./index-TcMYSotV.js";import{T as I}from"./textarea-DGNrVZoq.js";import{F as S,a as i,b as n,c as t,d as l,e as o}from"./form-xz68HsE9.js";import{u as F,t as L,z as r}from"./zod-CnCpVjpE.js";import{s as P}from"./storage-BSit0ain.js";import{I as c}from"./input-VpsYF4Vr.js";import{C as A,b as k,d as E,a as D}from"./card-P2OsDbbh.js";import{A as R}from"./arrow-left-DUUYJY6r.js";import{U as B}from"./upload-CtqGUzkq.js";import"./label-BmxbEDFR.js";const O=r.object({name:r.string().min(2,{message:"Name must be at least 2 characters"}),description:r.string().min(10,{message:"Description must be at least 10 characters"}),address:r.object({street:r.string().min(1,{message:"Street is required"}),city:r.string().min(1,{message:"City is required"}),state:r.string().min(1,{message:"State is required"}),zipCode:r.string().min(1,{message:"Zip code is required"})}),contactInfo:r.object({phone:r.string().min(10,{message:"Phone number must be at least 10 digits"}),email:r.string().email({message:"Invalid email address"}),website:r.string().optional()}),certifications:r.string()}),Z=()=>{const h=w(),[j,f]=b.useState(null),[g,N]=b.useState(null),a=F({resolver:L(O),defaultValues:{name:"",description:"",address:{street:"",city:"",state:"",zipCode:""},contactInfo:{phone:"",email:"",website:""},certifications:""}}),y=s=>{var m;const d=(m=s.target.files)==null?void 0:m[0];if(d){f(d);const x=new FileReader;x.onloadend=()=>{N(x.result)},x.readAsDataURL(d)}},v=async s=>{try{let d=null;if(j){const C=`${Date.now()}-${j.name}`;d=await P.uploadImage("labs",C,j)}const m={...s,image:d||"default-lab.jpg"};if(!(await fetch("/api/labs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).ok)throw new Error("Failed to add lab");u.success("Lab added successfully"),h("/lab-dashboard")}catch(d){console.error("Failed to add lab:",d),u.error("Failed to add lab. Please try again.")}};return e.jsx("div",{className:"min-h-screen bg-background pt-16 pb-12",children:e.jsxs("div",{className:"container max-w-3xl mx-auto p-4",children:[e.jsxs(p,{variant:"ghost",className:"mb-6",onClick:()=>h("/lab-dashboard"),children:[e.jsx(R,{className:"h-4 w-4 mr-2"})," Back to Dashboard"]}),e.jsxs(A,{children:[e.jsx(k,{children:e.jsx(E,{className:"text-2xl",children:"Add New Lab"})}),e.jsx(D,{children:e.jsx(S,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(v),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Basic Information"}),e.jsx(i,{control:a.control,name:"name",render:({field:s})=>e.jsxs(n,{children:[e.jsx(t,{children:"Lab Name"}),e.jsx(l,{children:e.jsx(c,{placeholder:"Enter lab name",...s})}),e.jsx(o,{})]})}),e.jsx(i,{control:a.control,name:"description",render:({field:s})=>e.jsxs(n,{children:[e.jsx(t,{children:"Description"}),e.jsx(l,{children:e.jsx(I,{placeholder:"Describe your lab, specialties, etc.",rows:4,...s})}),e.jsx(o,{})]})}),e.jsxs("div",{children:[e.jsx(t,{children:"Lab Image"}),e.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex flex-col items-center justify-center cursor-pointer hover:border-primary transition-colors",onClick:()=>{var s;return(s=document.getElementById("lab-image"))==null?void 0:s.click()},children:[e.jsx(B,{className:"h-8 w-8 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Click to upload image"}),e.jsx("input",{placeholder:"Enter value",title:"Enter value",type:"file",id:"lab-image",accept:"image/*",className:"hidden",onChange:y})]}),g&&e.jsx("div",{className:"h-24 w-24 relative rounded-md overflow-hidden",children:e.jsx("img",{src:g,alt:"Preview",className:"h-full w-full object-cover"})})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Address"}),e.jsx(i,{control:a.control,name:"address.street",render:({field:s})=>e.jsxs(n,{children:[e.jsx(t,{children:"Street"}),e.jsx(l,{children:e.jsx(c,{placeholder:"Street address",...s})}),e.jsx(o,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(i,{control:a.control,name:"address.city",render:({field:s})=>e.jsxs(n,{children:[e.jsx(t,{children:"City"}),e.jsx(l,{children:e.jsx(c,{placeholder:"City",...s})}),e.jsx(o,{})]})}),e.jsx(i,{control:a.control,name:"address.state",render:({field:s})=>e.jsxs(n,{children:[e.jsx(t,{children:"State"}),e.jsx(l,{children:e.jsx(c,{placeholder:"State",...s})}),e.jsx(o,{})]})})]}),e.jsx(i,{control:a.control,name:"address.zipCode",render:({field:s})=>e.jsxs(n,{children:[e.jsx(t,{children:"PIN Code"}),e.jsx(l,{children:e.jsx(c,{placeholder:"PIN code",...s})}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(i,{control:a.control,name:"contactInfo.phone",render:({field:s})=>e.jsxs(n,{children:[e.jsx(t,{children:"Phone Number"}),e.jsx(l,{children:e.jsx(c,{placeholder:"Phone number",...s})}),e.jsx(o,{})]})}),e.jsx(i,{control:a.control,name:"contactInfo.email",render:({field:s})=>e.jsxs(n,{children:[e.jsx(t,{children:"Email"}),e.jsx(l,{children:e.jsx(c,{placeholder:"Email address",...s})}),e.jsx(o,{})]})})]}),e.jsx(i,{control:a.control,name:"contactInfo.website",render:({field:s})=>e.jsxs(n,{children:[e.jsx(t,{children:"Website (Optional)"}),e.jsx(l,{children:e.jsx(c,{placeholder:"Website URL",...s})}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Certifications"}),e.jsx(i,{control:a.control,name:"certifications",render:({field:s})=>e.jsxs(n,{children:[e.jsx(t,{children:"Certifications & Accreditations"}),e.jsx(l,{children:e.jsx(c,{placeholder:"e.g. NABL, ISO",...s})}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"pt-6 border-t flex justify-end space-x-4",children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>h("/lab-dashboard"),children:"Cancel"}),e.jsx(p,{type:"submit",children:"Add Lab"})]})]})})})]})]})})};export{Z as default};
