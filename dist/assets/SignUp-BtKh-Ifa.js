import{q as F,R as p,r as R,w as b,s as e,B as f,x as E,E as g}from"./index-DgBcbMcU.js";import{F as I,a as h,b as l,c as t,d as c,e as i}from"./form-DsYPgIbr.js";import{R as _,a as N}from"./radio-group-Z-2hFF1z.js";import{u as A,t as L,z as n}from"./zod-Ne4FsdIx.js";import{I as d}from"./input-CJYTmRyd.js";import{C as z,c as U,d as V}from"./card-CEAmbz21.js";import{E as v,a as S}from"./eye-62CEUVaH.js";import{A as B}from"./arrow-right-D6WpxGYQ.js";import"./label-DqPonXmE.js";import"./index-ENNysaz7.js";import"./index-C06rPHWt.js";import"./index-CokvLBSM.js";import"./index-BBzG8Kdz.js";const G=n.object({name:n.string().min(2,{message:"Name must be at least 2 characters"}),email:n.string().email({message:"Invalid email address"}),phone:n.string().min(10,{message:"Phone number must be at least 10 digits"}),password:n.string().min(8,{message:"Password must be at least 8 characters"}),confirmPassword:n.string(),role:n.enum(["user","lab_owner"])}).refine(o=>o.password===o.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),Z=()=>{const o=F(),[m,C]=p.useState(!1),[x,P]=p.useState(!1),[u,w]=p.useState(!1),[y,j]=p.useState(null);R.useEffect(()=>{if(b.isAuthenticated()){const s=b.getCurrentUserRole();o(s==="lab_owner"?"/lab-dashboard":"/profile")}},[o]);const r=A({resolver:L(G),defaultValues:{name:"",email:"",phone:"",password:"",confirmPassword:"",role:"user"}}),k=async s=>{try{w(!0),j(null);const a=await b.signup({name:s.name,email:s.email,phone:s.phone,password:s.password,role:s.role});g.success("Account created successfully! Welcome to Ekitsa."),a.role==="lab_owner"?o("/lab-dashboard"):o("/profile")}catch(a){console.error("Sign up error:",a),typeof a=="object"&&a!==null&&"response"in a&&a.response&&typeof a.response=="object"&&"data"in a.response&&a.response.data&&typeof a.response.data=="object"&&"message"in a.response.data?(j(a.response.data.message||"Registration failed. Please try again."),g.error(a.response.data.message||"Registration failed. Please try again.")):(j("Registration failed. Please try again."),g.error("Registration failed. Please try again."))}finally{w(!1)}};return e.jsx("div",{className:"min-h-screen bg-background flex flex-col justify-center items-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold mt-6",children:"Create your account"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Join Ekitsa to book lab tests and doctor appointments"})]}),e.jsxs(z,{className:"shadow-lg border-2 border-primary/10",children:[e.jsxs(U,{className:"pt-6",children:[y&&e.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-md text-sm animate-shake",role:"alert",children:[e.jsx("span",{className:"font-semibold",children:"Error:"})," ",y]}),e.jsx(I,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(k),className:"space-y-4",children:[e.jsx(h,{control:r.control,name:"name",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Full Name"}),e.jsx(c,{children:e.jsx(d,{placeholder:"John Doe",...s,"aria-invalid":!!r.formState.errors.name,className:r.formState.errors.name?"border-red-500 focus:border-red-500 ring-red-300":""})}),e.jsx(i,{})]})}),e.jsx(h,{control:r.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Email"}),e.jsx(c,{children:e.jsx(d,{type:"email",placeholder:"john@example.com",...s,"aria-invalid":!!r.formState.errors.email,className:r.formState.errors.email?"border-red-500 focus:border-red-500 ring-red-300":""})}),e.jsx(i,{})]})}),e.jsx(h,{control:r.control,name:"phone",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Phone Number"}),e.jsx(c,{children:e.jsx(d,{type:"tel",placeholder:"9876543210",...s,"aria-invalid":!!r.formState.errors.phone,className:r.formState.errors.phone?"border-red-500 focus:border-red-500 ring-red-300":""})}),e.jsx(i,{})]})}),e.jsx(h,{control:r.control,name:"role",render:({field:s})=>e.jsxs(l,{className:"space-y-3",children:[e.jsx(t,{children:"I am registering as a"}),e.jsxs(_,{onValueChange:s.onChange,defaultValue:s.value,className:"flex gap-4","aria-label":"Select your role",children:[e.jsxs("div",{className:`flex items-center space-x-2 px-3 py-2 rounded-lg cursor-pointer border transition-colors ${s.value==="user"?"border-primary bg-primary/10":"border-gray-300"}`,onClick:()=>s.onChange("user"),tabIndex:0,role:"radio","aria-checked":s.value==="user",children:[e.jsx(N,{value:"user",id:"user"}),e.jsx(t,{htmlFor:"user",className:"font-normal",children:"Patient / User"})]}),e.jsxs("div",{className:`flex items-center space-x-2 px-3 py-2 rounded-lg cursor-pointer border transition-colors ${s.value==="lab_owner"?"border-primary bg-primary/10":"border-gray-300"}`,onClick:()=>s.onChange("lab_owner"),tabIndex:0,role:"radio","aria-checked":s.value==="lab_owner",children:[e.jsx(N,{value:"lab_owner",id:"lab_owner"}),e.jsx(t,{htmlFor:"lab_owner",className:"font-normal",children:"Lab Owner"})]})]}),e.jsx(i,{})]})}),e.jsxs(l,{children:[e.jsx(t,{children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{children:e.jsx(d,{type:m?"text":"password",placeholder:"********",...r.register("password"),"aria-describedby":"password-helper","aria-invalid":!!r.formState.errors.password,className:r.formState.errors.password?"border-red-500 focus:border-red-500 ring-red-300":""})}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"absolute right-1 top-1",onClick:()=>C(!m),tabIndex:-1,"aria-label":m?"Hide password":"Show password",children:m?e.jsx(v,{className:"h-4 w-4"}):e.jsx(S,{className:"h-4 w-4"})}),e.jsx("p",{id:"password-helper",className:"text-xs text-muted-foreground mt-1",children:"Password must be at least 8 characters."})]}),e.jsx(i,{})]}),e.jsxs(l,{children:[e.jsx(t,{children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{children:e.jsx(d,{type:x?"text":"password",placeholder:"********",...r.register("confirmPassword")})}),e.jsx(f,{type:"button",variant:"ghost",size:"icon",className:"absolute right-1 top-1",onClick:()=>P(!x),children:x?e.jsx(v,{className:"h-4 w-4"}):e.jsx(S,{className:"h-4 w-4"})})]}),e.jsx(i,{})]}),e.jsx(f,{type:"submit",className:"w-full mt-6 font-semibold text-base py-2 transition-transform duration-100 active:scale-95",disabled:u,"aria-busy":u,children:u?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing up..."]}):e.jsxs(e.Fragment,{children:["Sign Up ",e.jsx(B,{className:"ml-2 h-4 w-4"})]})})]})})]}),e.jsx(V,{className:"flex justify-center border-t p-4",children:e.jsxs("div",{className:"text-sm text-center",children:["Already have an account?"," ",e.jsx(E,{to:"/login",className:"text-primary font-medium hover:underline",children:"Login"})]})})]})]})})};export{Z as default};
